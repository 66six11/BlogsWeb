# 魔法乐谱格式说明 (Sheet Music Format Guide)

## 基本格式

每行一个音符或和弦，格式为：
```
音符名 八度 时值
```

用空格或制表符分隔。

## 参数说明

### 1. 音符名 (Note Name)
支持12个半音，不区分大小写：
| 音符 | 说明 |
|------|------|
| C | Do |
| C# | Do升半音 |
| D | Re |
| D# | Re升半音 |
| E | Mi |
| F | Fa |
| F# | Fa升半音 |
| G | Sol |
| G# | Sol升半音 |
| A | La |
| A# | La升半音 |
| B | Si |

### 2. 八度 (Octave)
数字表示八度，编辑器当前支持第4和第5八度：
- `4` = 中央C所在八度 (C4是中央C)
- `5` = 高一个八度

### 3. 时值 (Duration)
以十六分音符为单位：
| 时值 | 音符类型 |
|------|----------|
| 1 | 十六分音符 |
| 2 | 八分音符 |
| 4 | 四分音符 |
| 8 | 二分音符 |
| 16 | 全音符 |

## 和弦 (Chords)

使用 `+` 符号连接同时播放的音符，时值写在最后：

```
音符1 八度 + 音符2 八度 + 音符3 八度 时值
```

### 和弦示例
```
# C大三和弦 (C-E-G)
C 4 + E 4 + G 4 4

# Am和弦 (A-C-E)  
A 4 + C 5 + E 5 4

# G7和弦
G 4 + B 4 + D 5 + F 5 4
```

## 注释

以 `#` 开头的行为注释，会被忽略。空行也会被忽略。

```
# 这是注释
```

## 示例乐谱

### 简单旋律示例
```
# 小星星片段
C 4 4
C 4 4
G 4 4
G 4 4
A 4 4
A 4 4
G 4 8
```

### 带升音的示例
```
# 带升音的旋律
E 4 2
G# 4 2
B 4 4
E 5 2
D# 5 2
B 4 4
```

### 和弦进行示例
```
# I-V-vi-IV 和弦进行 (C大调)
# C大三和弦
C 4 + E 4 + G 4 4
# G大三和弦
G 4 + B 4 + D 5 4
# Am小三和弦
A 4 + C 5 + E 5 4
# F大三和弦
F 4 + A 4 + C 5 4
```

### 旋律+和弦混合示例
```
# 旋律开始
E 5 2
D# 5 2
E 5 2
D# 5 2
# 和弦伴奏
E 4 + G# 4 + B 4 4
A 4 + C 5 + E 5 4
```

## 文件存放

将乐谱文件（.txt格式）放入 `/public/scores/` 目录，然后在 `config.ts` 的 `MEDIA_CONFIG.scores.files` 数组中添加文件名：

```typescript
scores: {
  folder: "/scores",
  files: ['sample.txt', 'your-song.txt']
}
```

## 注意事项

1. 单音符按顺序播放，每个音符的开始时间 = 上一个音符的结束时间
2. 和弦中的所有音符同时播放，共享同一个时值
3. 编辑器网格会根据音符自动延长
4. 播放会在最后一个音符结束后自动停止
5. 和弦的时值只需在最后一个音符后指定一次
