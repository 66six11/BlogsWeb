# 项目指南

## 1. 项目概述

### 1.1 项目背景

The Wandering Dev 是一个基于 React 19 + TypeScript 的个人博客和作品集网站，融合了魔法主题和现代 Web 技术。网站采用了响应式设计，支持暗色/亮色主题切换，并集成了 3D 粒子效果、音频响应式设计和 AI 聊天功能。

### 1.2 技术栈选择

| 技术类别 | 技术栈 | 版本 |
| --- | --- | --- |
| 前端框架 | React | 19.2.0 |
| 类型系统 | TypeScript | ~5.8.2 |
| 构建工具 | Vite | 6.2.0 |
| 状态管理 | Zustand | 5.0.9 |
| 样式框架 | Tailwind CSS | 4.1.17 |
| 3D 库 | Three.js | 0.160.0 |
| 音频库 | Tone.js | 14.7.77 |
| 路由 | React Router | 7.10.1 |
| AI 集成 | Google GenAI | 1.30.0 |

### 1.3 核心功能

- 魔法主题设计
- 3D 粒子效果和音频响应式设计
- 音乐播放器和乐谱编辑器
- AI 聊天功能
- 博客系统
- 作品集展示
- 暗色/亮色主题切换
- 响应式设计

### 1.4 项目亮点

- 采用现代化的技术栈，支持最新的 React 19 特性
- 融合了 3D 视觉效果和音频响应式设计
- 模块化的组件设计，易于扩展和维护
- 支持主题切换，提升用户体验
- 集成了 AI 聊天功能，增强用户互动

## 2. 环境搭建步骤

### 2.1 系统要求

- Node.js 18+ 
- npm 或 yarn 包管理器
- Git 版本控制工具

### 2.2 依赖安装

1. 克隆项目仓库
   ```bash
   git clone <repository-url>
   cd BlogsWeb
   ```

2. 安装依赖
   ```bash
   npm install
   ```

### 2.3 开发环境配置

1. 复制环境变量示例文件
   ```bash
   cp .env.local.example .env.local
   ```

2. 配置环境变量
   - `VITE_GITHUB_TOKEN`: GitHub API 访问令牌（可选，用于获取 GitHub 数据）
   - `VITE_GEMINI_API_KEY`: Google Gemini API 密钥（可选，用于 AI 聊天功能）

3. 启动开发服务器
   ```bash
   npm run dev
   ```

4. 访问开发服务器
   - 默认访问地址：`http://localhost:5173`

### 2.4 构建生产版本

```bash
npm run build
```

构建产物将生成在 `dist` 目录中。

## 3. 目录结构说明

### 3.1 核心目录解析

```
├── api/                 # API 路由（Vercel 函数）
│   ├── gemini/          # Google Gemini API 集成
│   └── github/          # GitHub API 集成
├── public/              # 静态资源
│   ├── music/           # 音乐文件
│   ├── scores/          # 乐谱文件（ABC 格式）
│   ├── styles/          # 全局样式
│   └── *.mp4/*.png      # 媒体资源
├── src/                 # 源代码
│   ├── components/      # React 组件
│   │   ├── common/      # 通用组件
│   │   ├── dev/         # 开发工具组件
│   │   ├── features/     # 功能组件
│   │   ├── icons/       # 图标组件
│   │   └── layout/       # 布局组件
│   ├── config/          # 配置文件
│   ├── constants/       # 常量定义
│   ├── core/            # 核心应用逻辑
│   ├── data/            # 数据文件
│   ├── dev/             # 开发相关代码
│   ├── lib/             # 工具库
│   ├── pages/           # 页面组件
│   ├── services/        # 服务层
│   ├── store/           # 状态管理
│   ├── styles/          # 样式文件
│   ├── types/           # TypeScript 类型定义
│   └── utils/           # 工具函数
├── docs/                # 项目文档
├── .env.local.example   # 环境变量示例
├── package.json         # 项目配置和依赖
├── tsconfig.json        # TypeScript 配置
└── vite.config.ts       # Vite 配置
```

### 3.2 组件设计规范

- 组件采用函数式组件，使用 React Hooks
- 组件命名采用 PascalCase 命名法
- 组件文件扩展名使用 `.tsx`
- 组件内部逻辑清晰，职责单一
- 组件样式优先使用 Tailwind CSS
- 复杂组件拆分为更小的子组件

### 3.3 文件命名规则

- 组件文件：`ComponentName.tsx`
- 类型定义文件：`types.ts` 或 `index.ts`
- 样式文件：`styles.css` 或 `index.css`
- 配置文件：`config.ts` 或 `index.ts`
- 工具函数文件：`utils.ts` 或 `index.ts`

## 4. 核心功能模块介绍

### 4.1 3D 效果模块

#### 4.1.1 Scene3D 组件

- **文件路径**: `src/components/features/3d/Scene3D.tsx`
- **功能描述**: 使用 Three.js 创建音频响应式粒子系统，粒子具有轨道旋转、垂直流动和波浪运动效果
- **核心特性**: 
  - 音频响应式设计
  - 粒子轨道旋转
  - 垂直流动效果
  - 波浪运动效果

#### 4.1.2 TextParticleSystem 组件

- **文件路径**: `src/components/features/3d/TextParticleSystem.tsx`
- **功能描述**: 创建文字形状的粒子系统，粒子从随机位置聚拢形成指定文字，并在形成后保持微小波动效果
- **核心特性**: 
  - 文字粒子效果
  - 粒子聚拢动画
  - 音频响应式设计
  - 粒子波动效果

### 4.2 音乐功能模块

#### 4.2.1 MusicPlayer 组件

- **文件路径**: `src/components/features/music/MusicPlayer.tsx`
- **功能描述**: 音乐播放器组件，支持播放、暂停、音量调节和进度控制
- **核心特性**: 
  - 支持多种音频格式
  - 进度条控制
  - 音量调节
  - 音频可视化

#### 4.2.2 PianoEditor 组件

- **文件路径**: `src/components/features/music/PianoEditor.tsx`
- **功能描述**: 钢琴编辑器组件，支持实时编辑和播放乐谱
- **核心特性**: 
  - 可视化钢琴键盘
  - 实时乐谱编辑
  - 乐谱播放
  - 支持 ABC 格式导入/导出

### 4.3 AI 聊天模块

#### 4.3.1 MagicChat 组件

- **文件路径**: `src/components/features/chat/MagicChat.tsx`
- **功能描述**: AI 聊天组件，集成 Google Gemini API，提供魔法主题的聊天体验
- **核心特性**: 
  - 与 Google Gemini API 集成
  - 魔法主题设计
  - 支持多种聊天模式
  - 响应式设计

### 4.4 博客系统模块

#### 4.4.1 BlogPage 组件

- **文件路径**: `src/pages/BlogPage.tsx`
- **功能描述**: 博客页面组件，展示博客文章列表和文章内容
- **核心特性**: 
  - 文章列表展示
  - 文章内容渲染
  - 目录导航
  - 搜索功能

#### 4.4.2 ObsidianRenderer 组件

- **文件路径**: `src/components/features/content/ObsidianRenderer.tsx`
- **功能描述**: Obsidian 风格的 Markdown 渲染器，支持多种 Obsidian 特性
- **核心特性**: 
  - Markdown 渲染
  - Obsidian 风格支持
  - 代码高亮
  - 数学公式支持

### 4.5 作品集模块

#### 4.5.1 ProjectsPage 组件

- **文件路径**: `src/pages/ProjectsPage.tsx`
- **功能描述**: 作品集页面组件，展示项目列表和项目详情
- **核心特性**: 
  - 项目列表展示
  - 项目详情页
  - 筛选功能
  - 搜索功能

## 5. API 接口文档

### 5.1 GitHub API

#### 5.1.1 获取 GitHub 仓库信息

- **端点**: `GET /api/github/repo`
- **参数**: 
  - `owner`: 仓库所有者
  - `repo`: 仓库名称
- **返回**: 仓库信息

#### 5.1.2 获取 GitHub 提交记录

- **端点**: `GET /api/github/commits`
- **参数**: 
  - `owner`: 仓库所有者
  - `repo`: 仓库名称
  - `path`: 文件路径（可选）
- **返回**: 提交记录列表

### 5.2 Google GenAI API

#### 5.2.1 生成文本

- **端点**: `POST /api/gemini/chat`
- **参数**: 
  - `message`: 用户输入消息
  - `model`: 模型名称（可选，默认: `gemini-1.5-flash`）
- **返回**: 生成的文本响应

## 6. 开发规范

### 6.1 代码风格规范

- 使用 TypeScript 编写代码
- 采用 ESLint 和 Prettier 进行代码检查和格式化
- 函数和变量命名采用 camelCase 命名法
- 类命名采用 PascalCase 命名法
- 常量命名采用 UPPER_CASE 命名法
- 缩进使用 2 个空格
- 每行代码长度不超过 120 个字符

### 6.2 注释规范

- 文件头部添加文件说明注释
- 函数和方法添加 JSDoc 注释
- 复杂逻辑添加实现思路注释
- 关键变量添加含义和使用场景注释
- 类添加用途和核心功能注释

### 6.3 Git 工作流

- 采用 Git Flow 工作流
- 主分支：`main`（生产分支）
- 开发分支：`develop`（开发分支）
- 特性分支：`feature/feature-name`
- 修复分支：`fix/bug-name`
- 发布分支：`release/vx.x.x`
- 热修复分支：`hotfix/bug-name`

### 6.4 分支管理策略

- 每个特性或修复创建一个新分支
- 分支命名清晰，描述性强
- 分支合并前必须通过代码审查和测试
- 分支合并后及时删除

## 7. 测试流程

### 7.1 单元测试

- 使用 Vitest 进行单元测试
- 测试文件与被测试文件放在同一目录下，命名为 `*.test.ts` 或 `*.spec.ts`
- 测试覆盖率要求：核心功能模块覆盖率达到 80% 以上

### 7.2 集成测试

- 使用 React Testing Library 进行集成测试
- 测试组件之间的交互
- 测试状态管理和 API 调用

### 7.3 E2E 测试

- 使用 Playwright 进行 E2E 测试
- 测试完整的用户流程
- 测试不同浏览器和设备

### 7.4 性能测试

- 使用 Lighthouse 进行性能测试
- 性能指标要求：
  - 首次内容绘制 (FCP) < 1.5s
  - 最大内容绘制 (LCP) < 2.5s
  - 累积布局偏移 (CLS) < 0.1
  - 首次输入延迟 (FID) < 100ms

## 8. 部署步骤

### 8.1 构建流程

1. 安装依赖
   ```bash
   npm install
   ```

2. 构建生产版本
   ```bash
   npm run build
   ```

3. 预览构建结果
   ```bash
   npm run preview
   ```

### 8.2 部署方式

#### 8.2.1 Vercel 部署

1. 登录 Vercel 账号
2. 连接 GitHub 仓库
3. 配置构建命令：`npm run build`
4. 配置输出目录：`dist`
5. 部署完成后访问提供的 URL

#### 8.2.2 GitHub Pages 部署

1. 修改 `vite.config.ts`，配置 base URL
2. 构建生产版本
3. 部署到 GitHub Pages

### 8.3 CI/CD 配置

- 使用 GitHub Actions 进行 CI/CD
- 配置自动构建和部署
- 配置测试和代码审查

## 9. 常见问题解决

### 9.1 开发环境问题

#### 9.1.1 端口被占用

- 问题：开发服务器启动失败，提示端口被占用
- 解决：修改 `vite.config.ts` 中的端口配置，或使用 `npm run dev -- --port 3000` 指定端口

#### 9.1.2 依赖安装失败

- 问题：`npm install` 失败
- 解决：
  1. 删除 `node_modules` 目录和 `package-lock.json` 文件
  2. 清理 npm 缓存：`npm cache clean --force`
  3. 重新安装依赖：`npm install`

### 9.2 构建问题

#### 9.2.1 构建失败

- 问题：`npm run build` 失败
- 解决：
  1. 检查 TypeScript 错误：`npx tsc --noEmit`
  2. 检查 ESLint 错误：`npx eslint .`
  3. 修复所有错误后重新构建

#### 9.2.2 构建产物过大

- 问题：构建产物过大，影响加载性能
- 解决：
  1. 使用代码分割：`React.lazy` 和 `Suspense`
  2. 优化依赖，移除不必要的库
  3. 配置 Vite 压缩选项

### 9.3 部署问题

#### 9.3.1 环境变量配置错误

- 问题：部署后 API 调用失败
- 解决：检查环境变量配置，确保所有必需的环境变量都已正确设置

#### 9.3.2 404 错误

- 问题：部署后访问页面出现 404 错误
- 解决：
  1. 检查路由配置
  2. 配置 Vite 基础 URL
  3. 配置服务器重定向规则

### 9.4 性能问题

#### 9.4.1 页面加载缓慢

- 问题：页面加载时间过长
- 解决：
  1. 优化图片和媒体资源
  2. 使用懒加载
  3. 优化第三方库
  4. 配置缓存策略

#### 9.4.2 动画卡顿

- 问题：3D 粒子效果或音频响应式动画卡顿
- 解决：
  1. 优化 Three.js 性能
  2. 减少粒子数量
  3. 优化着色器代码
  4. 使用 Web Workers 处理复杂计算

## 10. 附加资源

### 10.1 文档链接

- React 文档：https://react.dev/
- TypeScript 文档：https://www.typescriptlang.org/docs/
- Vite 文档：https://vite.dev/
- Tailwind CSS 文档：https://tailwindcss.com/
- Three.js 文档：https://threejs.org/docs/
- Zustand 文档：https://docs.pmnd.rs/zustand/getting-started/introduction

### 10.2 开发工具

- VS Code：https://code.visualstudio.com/
- Chrome DevTools：https://developer.chrome.com/docs/devtools/
- Lighthouse：https://developers.google.com/web/tools/lighthouse
- Playwright：https://playwright.dev/

### 10.3 设计资源

- Tailwind UI：https://tailwindui.com/
- Lucide Icons：https://lucide.dev/
- Unsplash：https://unsplash.com/
- Pexels：https://www.pexels.com/

---

**项目维护者**: [Your Name]
**最后更新**: 2025-12-13
**版本**: 1.0.0